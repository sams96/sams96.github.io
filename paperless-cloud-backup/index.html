<!doctype html><html prefix="og: http://ogp.me/ns#" lang=en><head itemscope itemtype=https://schema.org/Blog><meta charset=utf-8><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title itemprop=name>Paperless cloud backups | Sam Smith</title><meta property="og:title" content="Paperless cloud backups | Sam Smith"><meta itemprop=name content="Paperless cloud backups | Sam Smith"><meta name=application-name content="Paperless cloud backups | Sam Smith"><meta property="og:site_name" content="Sam Smith's Blog"><meta name=description content="My blog! I write about (mostly analog) photography and (mostly golang)
programming
"><meta itemprop=description content="My blog! I write about (mostly analog) photography and (mostly golang)
programming
"><meta property="og:description" content="My blog! I write about (mostly analog) photography and (mostly golang)
programming
"><base href=https://samsm.ch/paperless-cloud-backup/><link rel=canonical href=https://samsm.ch/paperless-cloud-backup/ itemprop=url><meta name=url content="https://samsm.ch/paperless-cloud-backup/"><meta name=twitter:url content="https://samsm.ch/paperless-cloud-backup/"><meta property="og:url" content="https://samsm.ch/paperless-cloud-backup/"><link rel=me href=https://toot.io/@mondoman712><link rel=me href=https://github.com/sams96><link rel=webmention href=https://webmention.io/samsm.ch/webmention><link rel=sitemap type=application/xml title=Sitemap href=https://samsm.ch/sitemap.xml><meta property="og:locale" content="en"><meta name=language content="English"><link rel=alternate hreflang=en href=https://samsm.ch/paperless-cloud-backup/ title=English><link rel=icon type=image/x-icon href=https://samsm.ch/favicon.ico><link rel=apple-touch-icon-precomposed href=https://samsm.ch/favicon.png><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta property="og:updated_time" content=0001-01-01T00:00:00Z><style>:root{--color-grey:#595959}@font-face{font-family:cmu;font-style:normal;src:url(https://cdn.jsdelivr.net/gh/dreampulse/computer-modern-web-font/font/Serif/cmunrm.woff)format("woff");font-display:swap}@font-face{font-family:cmu;font-weight:700;src:url(https://cdn.jsdelivr.net/gh/dreampulse/computer-modern-web-font/font/Serif/cmunbx.woff)format("woff");font-display:swap}@font-face{font-family:cmu;font-style:italic;src:url(https://cdn.jsdelivr.net/gh/dreampulse/computer-modern-web-font/font/Serif/cmunti.woff)format("woff");font-display:swap}html{font-family:cmu,georgia,serif}body{background:#fff;color:#333;line-height:1.5;max-width:38em;margin:0 auto;text-align:justify;overflow:auto}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}.container{}h1{font-size:2.6667em}h2{font-size:1.3em;margin-bottom:0}h3{font-size:1em;margin-bottom:0}h1,h2,h3{text-justify:none}a{color:#1d60a3;text-decoration:none}a:active,a:hover{outline:0}a:hover,a:focus{border-bottom:1px solid rgba(163,29,29,.5)}a:active{color:#a31d1d;opacity:.9;border-bottom:1px solid rgba(163,29,29,.5)}.table-wrapper{overflow-x:auto}table{margin:1em auto;width:95%;border-spacing:0;border-collapse:collapse}thead{border-bottom:thin solid #000}th,td{padding:.25em}caption{margin:0 auto;font-style:italic}pre{padding:1em;background-color:#fff;max-width:100%;white-space:pre-wrap;word-break:keep-all}code,pre,kbd{font-family:computer modern typewriter,monospace;line-height:154%;text-align:left;font-size:16px}blockquote{border-left:2px solid #ccc;padding:.1em 1em;margin-left:.75em;padding-right:.1em}figcaption{font-style:italic}footer.bq{font-style:normal;float:right;margin-right:3em;border-top:none;margin-top:1.2em}p{text-indent:0;margin-top:.5em;margin-bottom:0}p:not(:empty)+p:not(:empty){margin-top:0;text-indent:2em}hr{height:1px;border:0;border-top:1px solid #ccc}ul ol,ol ol,ul ul{margin:0 2em}figcaption{display:block;color:var(--color-grey);line-height:1em;margin-bottom:1.5em;font-weight:200}header{display:flex;align-items:center;justify-content:space-between}header h1{font-size:1em;margin-top:1em;margin-bottom:0;font-weight:400}header h2{font-size:1em;margin:0;font-weight:400}header nav{margin-top:3em;max-width:100%;text-align:right;vertical-align:bottom;margin-bottom:0}header nav a{margin-left:2em}header a{color:#333}.site-title{font-size:2em;white-space:nowrap;font-weight:700}.site-header{border-bottom:thin solid #f1f1f1;margin-bottom:2em}main h1{margin-top:1em;font-weight:400;line-height:1.1em;margin-bottom:.5em;font-weight:600}.post-short-list:first-of-type{margin-top:1em}article:not(:last-of-type){padding-bottom:1em}.post-fist:not(:first-of-type):before,.post-list:not(:last-of-type):after{display:block;content:"";width:5em;height:1px;margin:0 auto;margin-top:1em;background-color:#d1d1d1}article header h1{font-size:1.35em;line-height:1.1em;margin-bottom:.5em;font-weight:600}article header h1 a{border:none;text-decoration:none;color:#333}.article-info{font-size:.75em;color:var(--color-grey);margin-top:.25em;text-align:left}.post .article-info{margin-top:2em}.article-info a{color:var(--color-grey)}.article-info a:hover{color:#a31d1d}.post-short-list .article-info{margin-top:0;margin-bottom:1.5em}.article-taxonomies{display:inline}.article-date{white-space:nowrap;font-size:.75em;color:var(--color-grey);font-style:italic}.article-categories{display:inline;list-style-type:none;padding:0}.article-categories li{display:inline;margin-right:1em}.article-tags{display:inline;list-style-type:none;padding:0;margin:0}.article-tags li{display:inline;margin-right:1em}article img{max-width:100%;width:100%;display:block;height:auto;margin:1rem auto}article figure{max-width:100%;display:block;height:auto;margin:0 auto .5em}.diptych figure{margin:0}article img+p:not(:empty),article figure+p:not(:empty),.diptych+p:not(:empty){margin-top:1em}article p:not(:empty)+img,article p:not(:empty)+figure,article p:not(:empty)+.diptych{margin-top:1em}.content>figure:first-child,.content>.diptych:first-child{margin-top:.5em}.read-more{font-size:.75em;margin-top:auto;margin-bottom:0;margin-left:auto;text-align:right;white-space:nowrap}.post-list-footer{display:flex;justify-content:space-between;margin-top:.5em}.divider{display:block;height:1px;border:0;border-top:thin solid #f1f1f1;width:25%;margin:1em auto}.terms{list-style-type:none;padding:0;line-height:2em}.pagination{display:flex;justify-content:space-between;margin-top:1em}.pagination{text-align:center}.pagination-item{background:#fafafa;padding:.5em .75em}.disabled{visibility:hidden}.pagination-item a{color:#333}.pagination-item a:hover,.pagination-item a:focus{color:#a31d1d;border-bottom:0}footer{margin-top:3em;font-size:16px}.site-footer{border-top:thin solid #f1f1f1;display:flex;justify-content:space-between;margin-top:.5em}footer nav{max-width:100%;text-align:right;margin-top:.5em;margin-bottom:.5em}footer nav a{margin-left:2em}footer a{color:#333}@media(max-width:840px){.main-wrapper{margin:0;max-width:none;overflow-x:hidden;padding-left:25px;padding-right:25px}.container{max-width:90%;margin:0 auto}.pagination-item{padding:.5em;font-size:14px}header{display:block}.site-header{text-align:center}header nav{margin-top:1em;max-width:100%;text-align:center;background:#fafafa;padding:.5em 0}header nav a:first-of-type{margin-left:0}header nav a{margin-left:5%}}.diptych{display:block;width:89em;margin:0 auto .5em;position:relative;right:21.5em;overflow:auto}.diptych img{height:auto;width:42em;box-sizing:border-box;float:left;margin:0 .25em 0}@media only screen and (max-width:88em){.diptych{width:100%;position:static}.diptych img{margin:0 auto .5em}}#mastodon-stats{display:none}#mastodon-comments-list{font-family:sans-serif;--font-size:12px;margin-top:12px!important}#mastodon-comments:before{display:block;content:"";width:5em;height:1px;margin:0 auto;margin-top:1em;background-color:#d1d1d1}#mastodon-comments{--comment-padding:1em}</style><base href=https://samsm.ch/paperless-cloud-backup/><link rel=canonical href=https://samsm.ch/paperless-cloud-backup/ itemprop=url><meta name=url content="https://samsm.ch/paperless-cloud-backup/"><meta property="og:url" content="https://samsm.ch/paperless-cloud-backup/"><meta name=google-site-verification content="iL6kgZOem7Wh12HPO2MFqCKL-KH5Jc7vJSdvVBDAZhQ"></head><body><div class=container><header class=site-header><h1 class=site-title><a href=https://samsm.ch/>Sam Smith</a></h1><nav><a href=/posts/ title>Archive</a>
<a href=/about/ title=About>About</a></nav></header><main id=main><article class=post><header><h1>Paperless cloud backups</h1></header><div class=content><p>I store all of my important (and many not so important) documents in my
<a href=https://paperless-ngx.com/>Paperless-ngx</a> instance running on my homelab.
Given this importance, I wanted to add an additional backup of my documents and
the metadata. Having them in cloud storage, while not ideal for privacy reasons,
would also give me a way to access the documents easily if I am unable to
directly for whatever reason.</p><p>I chose to use Dropbox for this, because I have a lot of space available from
sending invites years ago, and I have it synced onto my laptop which then gives
me an additional backup there too.</p></br><p>My initial instinct on how to solve this was to just run the dropbox daemon on
my homelab and create a symlink to wherever paperless stores my documents. I
quickly found that this wouldn&rsquo;t work for a couple of reasons:</p><ol><li>The dropbox daemon doesn&rsquo;t run on Arm, and my homelab is a Raspberry Pi.</li><li>Paperless doesn&rsquo;t store metadata in a way that&rsquo;s easy to backup.</li></ol><p>To solve 1., I spent sometime looking into dropbox sync scripts that do work on
the Pi, and then writing my own script to do the same thing, but I wasn&rsquo;t happy
with any of these. It didn&rsquo;t take too much of this research before I was
reminded of the existance of <a href=https://rclone.org/>Rclone</a>, which is much more
robust than any of these scripts and allows me to do a one way sync, which is
ideal for my backup. It does bring a new problem to solve, which is that Rclone
doesn&rsquo;t run as a daemon, it needs to be triggered somehow to sync.</p><p>The solution to 2. is the <a href=https://docs.paperless-ngx.com/administration/#exporter>Paperless document exporter
script</a>. This is
Paperless&rsquo; recommended backup solution, it does provide all of the metadata and
there&rsquo;s an equivalent import script should the backup need to be restored.
Perfect, almost. This has the same issue as Rclone, in that it needs to be
triggered somehow.</p><p>So now we have two scripts that need to be run in sequence, frequently enough
such that my backup is kept sufficiently up to date. And I guess now is the time
to mention that I&rsquo;m running Paperless in docker and intend to keep using the
supplied image, so the backup should happen in my docker compose file.</p><h2 id=scheduling-the-backup>Scheduling the backup</h2><p>A simple timed schedule is a classic way to run backups, so that&rsquo;s what I went
with initially. Using the official Rclone docker image and
<a href=https://github.com/mcuadros/ofelia>Ofelia</a> to trigger the document export and
then Rclone sync. Below is an abbreviated docker compose file with hourly
backups added. The full version is available
<a href=https://gist.github.com/sams96/dc97a06fcb669465d0ca44d4041b2cad>here</a>, but if
you plan to use this I recommend basing yours on <a href=https://github.com/paperless-ngx/paperless-ngx/tree/main/docker/compose>a more up to date compose file
from
Paperless</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>version</span>:<span style=color:#bbb> </span><span style=color:#b84>&#34;3.4&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:navy>services</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:navy>broker</span>:<span style=color:#bbb> </span>...<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:navy>db</span>:<span style=color:#bbb> </span>...<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:navy>webserver</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>...<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>volumes</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- export:/usr/src/paperless/export<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>...<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>labels</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:navy>ofelia.enabled</span>:<span style=color:#bbb> </span><span style=color:#b84>&#34;true&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:navy>ofelia.job-exec.export-job.schedule</span>:<span style=color:#bbb> </span><span style=color:#b84>&#34;@hourly&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:navy>ofelia.job-exec.export-job.command</span>:<span style=color:#bbb> </span><span style=color:#b84>&#34;document_exporter --no-thumbnail ../export&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:navy>rclone</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>container_name</span>:<span style=color:#bbb> </span>rclone<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>image</span>:<span style=color:#bbb> </span>rclone/rclone:latest<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>volumes</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- export:/data<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- ./rclone/config:/root/.config/rclone<span style=color:#bbb> </span><span style=color:#998;font-style:italic># Place Rclone config here</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>labels</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:navy>ofelia.enabled</span>:<span style=color:#bbb> </span><span style=color:#b84>&#34;true&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>command</span>:<span style=color:#bbb> </span><span style=color:#b84>&#34;copy /data [remote:location]&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:navy>ofelia</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>image</span>:<span style=color:#bbb> </span>mcuadros/ofelia:latest<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>restart</span>:<span style=color:#bbb> </span>unless-stopped<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>depends_on</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- webserver<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>command</span>:<span style=color:#bbb> </span>daemon --docker<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>volumes</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- /var/run/docker.sock:/var/run/docker.sock:ro<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>labels</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:#998;font-style:italic># backup job is run 5 minutes after the hour to give the export time to run</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:navy>ofelia.job-run.backup.schedule</span>:<span style=color:#bbb> </span><span style=color:#b84>&#34;0 5 * * * *&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:navy>ofelia.job-run.backup.container</span>:<span style=color:#bbb> </span><span style=color:#b84>&#34;rclone&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:navy>volumes</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:navy>export</span>:<span style=color:#bbb>
</span></span></span></code></pre></div><p>Rather than figure out running Rclone once the document exporter has
finished, I just set it to run 5 minutes later, which works well enough. I&rsquo;ve
been using this for the past ~6 months with no issues.</p><p>However, I don&rsquo;t actually update documents in Paperless that often, maybe once
or twice a week, so it feels unnecessary to run the backups every hour but then
I don&rsquo;t want to leave documents un-backed up for too long. Ideally the backups
could be triggered when I actually do something in Paperless.</p><h2 id=backup-on-change>Backup on change</h2><p>Paperless provides the ability to send webhooks on document addition and update,
as part of their <a href=https://docs.paperless-ngx.com/usage/#workflows>workflows
feature</a>, so my next idea is
using this to trigger the document export and sync job instead of doing it
hourly. To do this I created <a href=https://github.com/sams96/float>float</a>. The idea
of float is essentially to provide similar functionality to Ofelia, but
triggered by webhooks instead of on a schedule.</p></div><div class=article-info><div class=article-taxonomies></div></div><meta name=fediverse:creator content="@mondoman712@toot.io"></article></main><footer class=site-footer><p>Â© Sam Smith, 2026</p><nav><a href=/tags/ title=Tags>Tags</a>
<a href=/categories/ title=Categories>Categories</a></nav></footer></div></body></html>