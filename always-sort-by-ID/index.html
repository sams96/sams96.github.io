<!doctype html><html prefix="og: http://ogp.me/ns#" lang=en><head itemscope itemtype=https://schema.org/Blog><meta charset=utf-8><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title itemprop=name>Always Sort by ID — An Interesting Gotcha | Sam Smith</title>
<meta property="og:title" content="Always Sort by ID — An Interesting Gotcha | Sam Smith"><meta itemprop=name content="Always Sort by ID — An Interesting Gotcha | Sam Smith"><meta name=application-name content="Always Sort by ID — An Interesting Gotcha | Sam Smith"><meta property="og:site_name" content="Sam Smith's Blog"><meta name=description content="My blog! I write about (mostly analog) photography and (mostly golang)
programming
"><meta itemprop=description content="My blog! I write about (mostly analog) photography and (mostly golang)
programming
"><meta property="og:description" content="My blog! I write about (mostly analog) photography and (mostly golang)
programming
"><base href=https://sams96.github.io/always-sort-by-ID/><link rel=canonical href=https://sams96.github.io/always-sort-by-ID/ itemprop=url><meta name=url content="https://sams96.github.io/always-sort-by-ID/"><meta name=twitter:url content="https://sams96.github.io/always-sort-by-ID/"><meta property="og:url" content="https://sams96.github.io/always-sort-by-ID/"><link rel=sitemap type=application/xml title=Sitemap href=https://sams96.github.io/sitemap.xml><meta property="og:locale" content="en"><meta name=language content="English"><link rel=alternate hreflang=en href=https://sams96.github.io/always-sort-by-ID/ title=English><link rel=icon type=image/x-icon href=https://sams96.github.io/favicon.ico><link rel=apple-touch-icon-precomposed href=https://sams96.github.io/favicon.png><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta property="og:updated_time" content=2025-05-27T00:00:00Z><link rel=stylesheet href="https://sams96.github.io/css/style.css?rnd=1748371582"><script type=module src=../js/comments.js></script><link rel=stylesheet href=../css/comments.css><base href=https://sams96.github.io/always-sort-by-ID/><link rel=canonical href=https://sams96.github.io/always-sort-by-ID/ itemprop=url><meta name=url content="https://sams96.github.io/always-sort-by-ID/"><meta property="og:url" content="https://sams96.github.io/always-sort-by-ID/"><meta name=google-site-verification content="iL6kgZOem7Wh12HPO2MFqCKL-KH5Jc7vJSdvVBDAZhQ"></head><body><div class=container><header class=site-header><h1 class=site-title><a href=https://sams96.github.io/>Sam Smith</a></h1><nav><a href=/posts/ title>Archive</a>
<a href=/about/ title=About>About</a>
<a rel=me href=https://toot.io/@mondoman712 hidden></a></nav></header><main id=main><article class=post><header><h1>Always Sort by ID — An Interesting Gotcha</h1></header><div class=article-date>27 May 2025</div><div class=content><p>If you&rsquo;re writing a database query for your web service and there&rsquo;s pagination,
you should always sort by a unique field like ID. This should also be done on
top of any other sorting. Otherwise you can get double entries or lose results
across pages.</p></br><p>A sort can be non-determinstic, as in if you have multiple items with the same
value in the field you are sorting by, there are multiple valid ways to sort it.
This can be okay, until you need that sorting to persist through multiple
queries, as you will when using pagination. This means that your query for your
second page could sort your results differently and give the same entry again,
or completely miss an entry. In the example below, both tables show valid ways
to sort by Customer Name, but give different results which in this case leads to
one order being missed and another shown twice.</p><h3 id=page-1>Page 1</h3><p>The first two results are returned.</p><table><thead><tr><th></th><th><strong>ID</strong></th><th><strong>Customer name</strong></th><th><strong>Item Ordered</strong></th></tr></thead><tbody><tr><td>-></td><td>1</td><td>Alan</td><td>Apple</td></tr><tr><td>-></td><td>2</td><td>Betty</td><td>Banana</td></tr><tr><td></td><td>3</td><td>Betty</td><td>Grape</td></tr><tr><td></td><td>4</td><td>Callum</td><td>Apple</td></tr></tbody></table><h3 id=page-2>Page 2</h3><p>Now with an offset of 2 the third and forth results are returned, but because we
are sorting in an non-determinstic way, the order has changed and we get
different results than expected.</p><table><thead><tr><th></th><th><strong>ID</strong></th><th><strong>Customer name</strong></th><th><strong>Item Ordered</strong></th></tr></thead><tbody><tr><td></td><td>1</td><td>Alan</td><td>Apple</td></tr><tr><td></td><td>3</td><td>Betty</td><td>Grape</td></tr><tr><td>-></td><td>2</td><td>Betty</td><td>Banana</td></tr><tr><td>-></td><td>4</td><td>Callum</td><td>Apple</td></tr></tbody></table><p>This only applies when using the classic <code>LIMIT</code> and <code>OFFSET</code> method of
pagination. <a href=https://www.citusdata.com/blog/2016/03/30/five-ways-to-paginate/>Other methods are
available</a>,
but those tend to come with other downsides that make them less viable for the
type of web services I work on, requiring either more resources or less
flexibility.</p><p>The simple solution here is to just always include a sort by a unique ID, on top
of any existing sorting or any requested by the client. That way your sorting is
always deterministic and no results are lost.</p></div><div class=article-info><div class=article-taxonomies><ul class=article-categories><li><a href=https://sams96.github.io/categories/programming>programming</a></li></ul></div></div><div id=mastodon-comments><h2>Comments</h2><p>You can comment on this post by replying to <a href=https://toot.io/@mondoman712/114581276592302845>this toot.</a></p><oom-comments mastodon=https://toot.io/@mondoman712/114581276592302845></br></oom-comments></div><meta name=fediverse:creator content="@mondoman712@toot.io"></article></main><footer class=site-footer><p>© Sam Smith, 2025</p><nav><a href=/tags/ title=Tags>Tags</a>
<a href=/categories/ title=Categories>Categories</a></nav></footer></div></body></html>